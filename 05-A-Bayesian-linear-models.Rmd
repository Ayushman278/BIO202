---
layout: topic
title: "Bayesian Inference from Linear Models"
author: Jes, Jamie
output: html_document
---

**Assigned Reading:**

> Chapters 3, 4.1, 8.4, 9.2, in Korner-Nievergelt et al. 2015. *Bayesian data analysis in ecology using linear models with R, BUGS, and Stan.* Elsevier. [link](http://www.sciencedirect.com/science/book/9780128013700)
>
> \* These chapters use the same functions you have already seen. Read the assigned sections focusing on how we make Bayesian inferences from models fit with these functions.

**Optional Reading:**

> Chapters 5, 4.2, 8, 9, in Korner-Nievergelt et al. 2015. *Bayesian data analysis in ecology using linear models with R, BUGS, and Stan.* Elsevier. [link](http://www.sciencedirect.com/science/book/9780128013700) 
>
> \* Chapter 4.2 focuses on ANOVA-type models while the rest of chapters 8 and 9 focus on Binomial and Binary models.

```{r include = FALSE}
# This code block sets up the r session when the page is rendered to html
# include = FALSE means that it will not be included in the html document

# Write every code block to the html document 
knitr::opts_chunk$set(echo = TRUE)

# Write the results of every code block to the html document 
knitr::opts_chunk$set(eval = TRUE)

# Define the directory where images generated by knit will be saved
knitr::opts_chunk$set(fig.path = "images/05-A/")

# Set the web address where R will look for files from this repository
# Do not change this address
repo_url <- "https://raw.githubusercontent.com/fukamilab/BIO202/master/"
```

### Key Points

Differences between Frequentist and Bayesian approach to statistical inference:

**See Table 8.1 in the reading.**

| Bayesian         | Frequentist       |
|------------------|-------------------|
| Make probabalistic statements about our state of knowledge. | Ask how parameter estimates change if data collected many times. |
| Calculate probability of hypothesis, given observed data.| Calculate probability of data, given null hypothesis. |
| Likelihood is a function that calculates probability for any set of data and parameters. | Likelihood is a value- the probability of the observed set of data, given a specific model and estimated parameters.|
| Inference based on samples of parameters from the posterior distribution. | Inference based on null hypothesis tests on values of estimated parameters and their SE.|

Bayesian approach to statistical inference:

+ If  $\theta$ is a model and $y$ is observed data, then frequentists estimate $P(y|\theta)$ and Bayesians estimate $P(\theta|y)$.
+ $p(\theta|y)$ (the posterior distibution) $\propto$ $p(\theta)$ (prior information about parameters) $\times p(y|\theta)$ (the likelihood function)
+ Development of algorithms that sample from posterior $p(\theta|y)$ without knowing the prior probability of the data $p(y) = \int p(y|\theta)p(\theta) d\theta$ have made Bayesian inference accessible.
+ Types of posterior distributions:
    + Joint distribution
    + Marginal distribution
    + Conditional distribution
+ Make inferences by summarizing samples of parameters from the posterior distribution:
    + CrI: credibility intervals are based on quantiles: 90% CrI is between the 0.05 and 0.95 quantiles of the samples of a parameter. Use `quantile()`.
    + HPD: highest posterior density intervals use parameter values so that probability density within interval is never lower than probability density outside interval. Use `HPDinterval(as.mcmc())`, both functions from `coda` package.
    + Calculate samples of $\hat{y}$ to estimate uncertainty around predicted mean.
    + Use calculated samples of $\hat{y}$ together with estimated $\hat{\sigma}$ in the likelihood function to calculate predicted posterior values of data. (Combines uncertainty in parameter estimation with uncertainty in the probability model.)



Bayesian inference in R

+ Use the `sim()` function from `arm` package to simulate samples from the posterior for models fit with `lm()`, `glm()`, `glmer()`.
+ `sim` assumes uniform (flat) prior distributions on all parameters, and calculates the posterior distribution analytically.

### Analysis Example



### Discussion Questions





